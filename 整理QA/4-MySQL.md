# MySQL数据库

**Q:说一说MySQL的事务。**  
A:事务指的是对数据库中数据的一系列操作要么都成功，要么都失败。  
MySQL中MyISM存储引擎是不支持事务的，InnoDB是支持事务的。  
想要做到这点，一个数据库事务要满足ACID四个特性。
原子性保证不可分割。一致性要求事务发生前后数据都要完整。隔离性保证事务不能被其他事务干扰。持久性保证对数据的改变是永久性的。
  
如果在没有事务隔离的时候，对数据的读取会出现脏读、幻读和不可重复读。  
脏读：A读取到了B修改但是没有提交的数据。  
幻读：A多次读取的过程中被B修改掉了，A多次读取的结果的数量不一样。针对的是插入或者删除。  
不可重复读：A多次读取的过程中被B修改掉了，A多次读取的结果值不一样。针对的是修改。 
   
而一般数据库的隔离级别有四种：  
读未提交：是最低的级别，不能避免脏读、幻读和不可重复读。  
读已提交：是Oracle默认的隔离级别，可以避免脏读。  
可重复读：是MySQL默认的隔离级别，可以避免脏读和不可重复读。  
序列化：可以避免脏读幻读和不可重复读。  
  
另外数据库一般都有7种传播行为，什么是传播行为，也就是一个事务遇到另一个事务，改如何控制：  
常用的是下面这两种：  
propagation_required 需要传播 如果当前没有事务，就创建一个新事务，如果当前存在事务，就加入该事务     
propagation_supports 支持传播 如果当前存在事务，就加入该事务，如果当前不存在事务，就以非事务执行    
   
  
**Q：说一说在开发过程中事务失效的场景。**  
A：在项目中，一般用@Transactional注解去标识事务方法。事务失效的场景有：  
1、使用事务方法没有被Spring管理。  
2、方法不是public的。  
3、自身调用问题，没有使用事务的方法调用使用事务的方法，或者事务方法调用了一个新开事务的方法，这些情况事务都不会起作用。  
4、数据源没有配置Spring的事务管理器。  
5、注解上使用了不支持事务的传播行为。  
6、异常被catch也会使得事务失效。  
7、异常类型错误，默认回滚的是RunTimeException，想要让抛出异常事务回滚，则需要在事务注解上标注Throwable异常类及其子类。  


